# 《操作系统课程设计》实验报告

[TOC]



------

## 课程设计题目

操作系统模拟程序的设计与实现。





## 课程设计目标和要求

### 目标

设计并实现一个具有操作系统基本功能的软件，具有操作系统的基本功能：

1.  进程管理功能。进程创建（new）、进程调度（scheduling）、进程阻塞（block）、 进程唤醒（wakeup）、进程同步（synchronous）等；
2. 内存管理功能。进程存储空间的分配和回收，空闲空间的管理等；
3. 文件系统。目录/文件的创建和删除、空间分配和回收 ；
4. 设备管理。设备的申请、分配、使用、释放等；
5. UI界面；
6. 中断机制。

### 基本要求

要求完成的最小功能集合 ：

1. 进程管理和调度 ；
2. 内存管理（存储分配与回收，进程交换） ；
3. 时钟管理：timer ；
4. 中断处理：中断响应、中断处理 ；
5. GUI，图形界面展示多道程序并发执行的过程（系统快照）。





## 需求分析

### 引言

#### 编写目的

本需求分析文档旨在系统、准确地描述操作系统模拟程序的功能与运行需求，为后续的系统设计、开发、测试与维护提供明确依据。文档面向本项目的开发者、测试人员以及指导教师，作为课程设计过程中的重要技术参考材料，确保系统功能设计满足实验教学目标，系统行为与用户预期保持一致。

#### 项目背景

本项目以“操作系统模拟程序的设计与实现”为课题，模拟实现简化版操作系统内核功能，并通过前端图形界面进行动态展示和交互。系统以多进程调度为核心，集成内存管理、文件操作、设备请求与中断处理机制，帮助我们通过自己动手实践，以可视化方式深入理解操作系统的基本运行原理与模块协作机制。



### 总体描述

#### 系统目标

本项目旨在开发一个基于 Web 的操作系统模拟程序，集成进程管理、内存管理、文件操作、设备请求与中断处理机制等模块。系统通过模拟真实操作系统中的关键组件与行为，达成操作系统内核的仿真实现。

用户可以在浏览器进入操作系统界面，通过界面的Shell与操作系统进行交互，并实时展示系统快照。

操作系统提供丰富广泛的指令可供用户使用，容纳了各种文件操作，程序编写，程序并发执行，程序互斥读写文件，外设使用，内存分配，虚拟内存扩展等功能。

具体目标如下：

1. 功能完整：实现操作系统核心模块的功能，包括进程生命周期管理、逻辑地址映射、页表机制、磁盘块分配、文件锁、设备中断处理等。

2. 结构清晰：采用模块化架构，后端以 Spring Boot 框架搭建，前端以原生 JavaScript 实现，逻辑层次分明。

3. 交互直观：通过图形界面展示系统快照，包括内存、磁盘、设备、进程等实时状态，结合模拟终端进行指令输入与控制。

4. 模拟真实环境：支持多核并发执行、时间片调度、进程抢占、页置换等机制，尽可能还原真实操作系统的执行过程。



#### 用户特征

本系统面向计算机及相关专业的本科生与教师，主要用于操作系统功能的演示与学生自我实践。用户具有一定的编程基础，能够理解命令行操作、以及操作系统的基本原理。



#### 系统功能概览

系统划分为七个核心功能模块，分别为：

1. Shell交互功能：提供类 Unix 命令行界面，支持文件管理、目录切换、程序执行、进程终止等指令，通过终端与后端交互。
2. 进程管理模块：实现进程的创建、调度、阻塞、唤醒与终止；支持多种调度策略；支持多 CPU 并发模拟执行。
3. 内存管理模块：实现页式管理机制，支持逻辑地址到物理地址的转换、缺页中断、TLB缓存、页置换算法等。
4. 文件管理模块：支持目录树结构、文件读写与编辑、磁盘块分配与释放，文件内容映射为进程执行指令集。
5. 设备管理模块：模拟打印机、USB、扫描仪等设备，支持进程发起设备请求，设备完成后触发中断唤醒阻塞进程。
6. 中断管理模块：处理时钟中断、I/O中断、文件锁唤醒等事件，实现多进程抢占与异步事件响应。
7. 系统快照展示模块：自动采集系统状态，包括运行进程、内存分配、磁盘使用、目录结构、设备状态等，通过前端页面可视化展示。



#### 运行环境与约束

系统采用前后端分离架构，整体运行环境要求如下：

后端运行环境：

- Java 17，Spring Boot 3.4.4 框架
- 每次启动重置操作系统环境，不依赖数据库

前端环境：

- 原生 HTML + CSS + JavaScript
- 支持现代浏览器（Chrome、Edge）



### 功能需求

#### Shell交互功能

Shell 交互模块为用户提供统一的命令输入入口，用于操作系统核心功能的访问与控制。用户可通过模拟终端界面输入指令，与文件系统、进程调度器、内存管理器、设备管理器等模块进行交互。所有操作过程中的提示、反馈与系统状态变化均实时推送至前端终端输出区域。

Shell模块接收用户输入的字符串命令，对其进行语义解析和参数提取（实现一个简易Parser），根据命令类型，调用对应的模块进行功能执行。

Shell支持通过命令 `vi <filename>` 打开图形化文件编辑窗口，前端提供编辑界面，编辑完成后可提交保存。若文件不存在则新建文件且自动提示并创建，已存在文件直接载入编辑内容覆盖原本文件。用户可以通过命令 `vi <filename>` 编写自定义程序并通过 Shell 提交任务使其执行。

Shell支持根据当前所在目录动态更新终端提示符（如 `/root/dir1> instruction xxx`）。

以下是一个简单的顺序图，部分操作可能和实际实现有略微差异，该图仅用来理解数据流向与调用逻辑。

<img src="./report2025.assets/image-20250502160136945.png" alt="image-20250502160136945" style="zoom: 67%;" />



#### 进程管理功能



#### 内存管理功能



#### 文件管理功能



#### 设备管理功能



#### 中断管理功能



#### 系统快照展示功能

















## 开发环境

本操作系统模拟器项目基于 **Java 17 + Spring Boot 3.4.4** 构建，系统前后端分离。

### 后端环境

|                | 工具说明                                                     |
| -------------- | ------------------------------------------------------------ |
| **开发语言**   | Java 17                                                      |
| **框架**       | Spring Boot 3.4.4                                            |
| **构建工具**   | Maven（版本兼容 JDK 17）                                     |
| **主要依赖**   | spring-boot-starter-web、thymeleaf、lombok、javax.annotation |
| **开发工具**   | IntelliJ IDEA                                                |
| **日志输出**   | Server-Sent Events（SSE） 实时推送                           |
| **并发控制**   | 多线程 + BlockingQueue + 自定义调度器                        |
| **热部署支持** | Spring DevTools                                              |

### 前端环境

| 项目         | 配置 / 工具说明                                              |
| ------------ | ------------------------------------------------------------ |
| **页面结构** | HTML5 + 原生 JavaScript                                      |
| **样式框架** | CSS                                                          |
| **交互机制** | SSE（用于日志输出与快照更新）Fetch API（用于命令提交与 vi 编辑） |
| **调试工具** | Chrome 开发者工具、浏览器控制台                              |

### 项目目录结构

```
src/
├── main/
│   ├── java/
│   │   └── org.example.oscdspring/
│   │       ├── controller/         # 控制器
│   │       ├── device_management/
│   │       ├── file_disk_management/
│   │       ├── main/
│   │       ├── memory_management/
│   │       ├── process_management/
│   │       ├── interrupt_management/
│   │       ├── snapshot/           # 系统快照模块
│   │       └── util/               # 日志/快照服务等工具类
│   └── resources/
│       ├── static/                 # 前端 HTML/CSS/JS
│       └── application.properties
└── test/
```

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```



## 总体设计





## 详细设计

### Shell交互实现

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```

```cmd
mkdir <directory>		#创建目录
mkf <filename> <size>	#创建指定字节数的随机内容文本文件
cd <directory>		#切换目录（能够实现绝对路径解析）
cd..				#返回上一级
cat <filename>		#展示文件内容
ls					#展示当前目录下文件与目录
rm <filename>		#删除文件
rmdir <directory>		#删除空目录
rmrdir <directory>	#递归删除该目录下所有内容
shf <filename>		#查看该文件的磁盘块占用
vi <filename>		#编辑文件内容，若文件不存在则创建
exec <filename1> <priority1> [<filename2> <priority2> ...]	#运行指定文件并指定优先级
addevc <deviceName> <deviceId>				#增加外设
rmdevc <deviceName> <deviceId>				#删除外设
kill <pid>			#杀死进程
info dir			#查看目录树
info disk			#查看磁盘位图
Info memory			#查看内存
```



### 进程管理实现

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```

```cmd
C <time> # 								#模拟占用CPU时间，单位ms
R/W <filename> <readtime> # 			#不会往里面写真实的内容，重点在于读写互斥性
D <deviceName> <deviceID> <IOtime> # 		#外设ID
M <byte> # 								#申请使用的内存大小
MW/MR <logicAddress> <Bytes> # 			#写入指定长度随机数据或者读取指定长度数据
Q # 									#进程结束，释放资源
```



### 内存管理实现



### 文件管理实现



### 设备管理实现



### 中断管理实现



### 系统快照展示实现







## 程序清单

### 代码结构描述

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```

### 源代码

源代码见提交。





## 测试报告

### 测试环境

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```

### 测试计划

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```



### 三级标题：单元测试

这部分是针对某一模块的java代码的某些函数的测试，与整个系统无关，相当于给一个函数搭上脚手架。不需要覆盖很全，意思意思就行。可以让gpt随便跑点。

#### 四级标题：进程管理单元测试

描述被测试的函数，测试代码，执行结果。

#### 四级标题：内存管理单元测试

同上。

#### 四级标题：xxx单元测试……

同上。





### 三级标题：集成测试

####这部分是指在`StartupInitializer.java`中编写测试程序，并在网页运行，在前端观察结果是否符合预期，必要时需要截图，甚至作甘特图等图辅助说明。



#### Shell 测试（包含文件/目录系统测试）

##### 错误命令

<img src="./report2025.assets/image-20250502104933111.png" alt="image-20250502104933111" style="zoom:50%;" />

能够提示报错，符合预期。



##### `mkdir`

创建目录前：

<img src="./report2025.assets/屏幕截图 2025-05-02 103903.png" style="zoom:50%;" />

输入指令创建目录：

<img src="./report2025.assets/屏幕截图 2025-05-02 103913.png" alt="屏幕截图 2025-05-02 103913" style="zoom:50%;" />

创建目录后：

<img src="./report2025.assets/屏幕截图 2025-05-02 103920.png" alt="屏幕截图 2025-05-02 103920" style="zoom:50%;" />

出现名为a的文件夹。

<img src="./report2025.assets/image-20250502104708651.png" alt="image-20250502104708651" style="zoom:50%;" />

重名目录会报错，符合预期。



##### `mkf`与`cat`

创建文件前：

<img src="./report2025.assets/image-20250502104058030.png" alt="image-20250502104058030" style="zoom:50%;" />

创建文件：

<img src="./report2025.assets/image-20250502104152075.png" alt="image-20250502104152075" style="zoom:50%;" />

创建文件后：

<img src="./report2025.assets/image-20250502104208695.png" alt="image-20250502104208695" style="zoom:50%;" />

文件占用了10个块，符合预期。

创建另一个10字节文件并查看：

<img src="./report2025.assets/image-20250502104344779.png" alt="image-20250502104344779" style="zoom: 50%;" />

文件确实由10个随机的`char`构成，且显示正常。

<img src="./report2025.assets/image-20250502104754338.png" alt="image-20250502104754338" style="zoom:50%;" />

创建过大文件会提示空间不足。

<img src="./report2025.assets/image-20250502104818310.png" alt="image-20250502104818310" style="zoom:50%;" />

且磁盘块在创建过大文件失败时，保持原来大小不变，而不是占满。



##### `cd`与`cd..`

<img src="./report2025.assets/image-20250502104550666.png" alt="image-20250502104550666" style="zoom:50%;" />

功能均正常。

<img src="./report2025.assets/image-20250502104638028.png" alt="image-20250502104638028" style="zoom:50%;" />

输入错误路径会报错，符合预期。



##### `ls`

在根目录执行：

<img src="./report2025.assets/屏幕截图 2025-05-02 105145.png" style="zoom:50%;" />

符合根目录下内容：

<img src="./report2025.assets/屏幕截图 2025-05-02 105151.png" alt="屏幕截图 2025-05-02 105151" style="zoom: 50%;" />



##### `rm`

删除b：

<img src="./report2025.assets/屏幕截图 2025-05-02 105527.png" style="zoom:50%;" />

相应的回收其空间，符合预期：

<img src="./report2025.assets/屏幕截图 2025-05-02 105534.png" alt="屏幕截图 2025-05-02 105534" style="zoom:50%;" />

这时如果再创建文件：

<img src="./report2025.assets/屏幕截图 2025-05-02 105725.png" style="zoom:50%;" />

文件系统会遍历位图找到合适空间分配：

<img src="./report2025.assets/image-20250502105842321.png" alt="image-20250502105842321" style="zoom:50%;" />

删除不存在的文件会报错，符合预期：

<img src="./report2025.assets/image-20250502105903999.png" alt="image-20250502105903999" style="zoom:50%;" />



##### `rmdir`

删除空文件夹a：

<img src="./report2025.assets/屏幕截图 2025-05-02 110250.png" style="zoom:50%;" />

a被删除：

<img src="./report2025.assets/image-20250502110316091.png" alt="image-20250502110316091" style="zoom:50%;" />



##### `rmrdir`

递归删除文件夹d1：

<img src="./report2025.assets/屏幕截图 2025-05-02 110427.png" style="zoom:50%;" />

空间被回收：

<img src="./report2025.assets/屏幕截图 2025-05-02 110433.png" alt="屏幕截图 2025-05-02 110433" style="zoom:50%;" />

目录中全部内容被删除：

<img src="./report2025.assets/屏幕截图 2025-05-02 110440.png" alt="屏幕截图 2025-05-02 110440" style="zoom:50%;" />



##### `shf`

创建一个40960字节的文件。

<img src="./report2025.assets/屏幕截图 2025-05-02 110611.png" style="zoom:50%;" />

创建前磁盘情况：

<img src="./report2025.assets/屏幕截图 2025-05-02 110433-1746155241933-16.png" style="zoom:50%;" />

创建后磁盘情况：

<img src="./report2025.assets/image-20250502110732317.png" alt="image-20250502110732317" style="zoom:50%;" />

符合上面shf的输出结果。



##### `vi`

输入vi指令：

<img src="./report2025.assets/屏幕截图 2025-05-02 110952.png" style="zoom:50%;" />

若文件不存在，系统会自动为我们新建：

<img src="./report2025.assets/屏幕截图 2025-05-02 111001.png" style="zoom:50%;" />

输入文件内容：

<img src="./report2025.assets/屏幕截图 2025-05-02 111051.png" style="zoom:50%;" />

查看文件内容与磁盘块占用，符合预期：

<img src="./report2025.assets/屏幕截图 2025-05-02 111115.png" style="zoom:50%;" />



##### `exec`

创建一个文件，输入一段简易示例程序：

<img src="./report2025.assets/image-20250502111455781.png" alt="image-20250502111455781" style="zoom:50%;" />

输入指令开始执行：

<img src="./report2025.assets/image-20250502111548989.png" alt="image-20250502111548989" style="zoom:50%;" />

<img src="./report2025.assets/image-20250502111524176.png" alt="image-20250502111524176" style="zoom:50%;" />



##### `addevc`与`rmdevc`

<img src="./report2025.assets/image-20250502111832116.png" alt="image-20250502111832116" style="zoom:50%;" />

<img src="./report2025.assets/image-20250502111847973.png" alt="image-20250502111847973" style="zoom: 50%;" />

<img src="./report2025.assets/屏幕截图 2025-05-02 111907.png" style="zoom:50%;" />

<img src="./report2025.assets/屏幕截图 2025-05-02 111913.png" alt="屏幕截图 2025-05-02 111913" style="zoom:50%;" />



##### `kill`

```cmd
未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成未完成
```



##### `info`

<img src="./report2025.assets/屏幕截图 2025-05-02 112512.png" style="zoom:50%;" />

<img src="./report2025.assets/屏幕截图 2025-05-02 112520.png" alt="屏幕截图 2025-05-02 112520" style="zoom:50%;" />

<img src="./report2025.assets/屏幕截图 2025-05-02 112530.png" alt="屏幕截图 2025-05-02 112530" style="zoom:50%;" />



#### 四级标题：进程管理集成测试

描述测试程序，展示截图/界面输出，分析正确性。

#### 四级标题：内存管理集成测试

同上。

#### 四级标题：xxx集成测试……

同上。

#### 四级标题：总体测试

可能需要复杂的涉及全模块功能的测试。逻辑和上面一样，只是程序写的复杂一些。准备等上面写好了再做这个。







## 个人总结与体会

### 任泽高



### 安轶东



### 董佳鑫



### 路遥



### 杨皓岚



### 张志鑫



